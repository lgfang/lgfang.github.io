<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>BASH as a Command Line Interface</title>
<!-- 2015-12-09 Wed 15:06 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Fang Lungang" />
<link rel="stylesheet" type="text/css" href="../cssjs/lgfang.css" />

<script type="text/javascript" src="../cssjs/org-info.js">
/**
 *
 * @source: ../cssjs/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in ../cssjs/org-info.js.
 *
 * Copyright (C) 2012-2013 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in ../cssjs/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "1");
org_html_manager.set("LINK_HOME", "../../index.html");
org_html_manager.set("LINK_UP", "../index.html");
org_html_manager.set("LOCAL_TOC", "1");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "underline");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "0");
org_html_manager.set("VIEW", "showall");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div class="container-narrow">
<div id="content">
<h1 class="title">BASH as a Command Line Interface</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Change login shell</a></li>
<li><a href="#sec-2">Input and key binding</a>
<ul>
<li><a href="#sec-2-1">Getting &lt;Delete&gt; and &lt;Backspace&gt; to work just right</a></li>
<li><a href="#sec-2-2">To disable enable XON/XOFF flow control</a></li>
<li><a href="#sec-2-3">To enter special characters in Bash CLI</a></li>
<li><a href="#sec-2-4">Customize key bindings</a></li>
</ul>
</li>
<li><a href="#sec-3">Session types</a></li>
<li><a href="#sec-4">Commands types</a>
<ul>
<li><a href="#sec-4-1">To find out what a "command" really is</a></li>
<li><a href="#sec-4-2">To escape aliases</a></li>
</ul>
</li>
<li><a href="#sec-5">Navigating among directories</a>
<ul>
<li><a href="#sec-5-1">shell options</a></li>
<li><a href="#sec-5-2">pushd</a></li>
<li><a href="#sec-5-3">directory bookmark</a></li>
<li><a href="#sec-5-4">CDPATH</a></li>
<li><a href="#sec-5-5">cd to a similar hierarchy</a></li>
</ul>
</li>
<li><a href="#sec-6">Command history</a>
<ul>
<li><a href="#sec-6-1">Recall previous command</a></li>
<li><a href="#sec-6-2">To disable history temporarily</a>
<ul>
<li><a href="#sec-6-2-1">Ignore commands started with spaces</a></li>
<li><a href="#sec-6-2-2">Ignore all commands within current session</a></li>
</ul>
</li>
<li><a href="#sec-6-3">To edit command history</a>
<ul>
<li><a href="#sec-6-3-1">By editing history file</a></li>
<li><a href="#sec-6-3-2">Using <code>history -d</code></a></li>
</ul>
</li>
<li><a href="#sec-6-4">Related shell options</a></li>
<li><a href="#sec-6-5">Related key binding</a></li>
</ul>
</li>
<li><a href="#sec-7">Command completion</a>
<ul>
<li><a href="#sec-7-1">Completion scripts</a></li>
<li><a href="#sec-7-2">Write your own simple complete</a></li>
</ul>
</li>
<li><a href="#sec-8">Make use of "Job Control"</a></li>
<li><a href="#sec-9">Colors</a>
<ul>
<li><a href="#sec-9-1">Colors for <code>ls</code></a></li>
<li><a href="#sec-9-2">Colors for PS1</a></li>
<li><a href="#sec-9-3">Reference:</a></li>
<li><a href="#sec-9-4">To show each one of 256 colors in bash</a></li>
</ul>
</li>
<li><a href="#sec-10">The safer "rm"</a></li>
<li><a href="#sec-11">Why "cannot access parent directories"</a></li>
<li><a href="#sec-12">Why command output does not show up realtime</a></li>
<li><a href="#sec-13">My profile</a></li>
</ul>
</div>
</div>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Change login shell</h2>
<div class="outline-text-2" id="text-1">
<p>
Run <code>chsh</code> (change shell) (or <code>ypchsh</code> if prompted).
</p>

<p>
It will check <code>/etc/shells</code> (man "shells"). If the new shell is not valid,
you'll get something like this:
</p>
<pre class="example">
/bin/bash is unacceptable as a new shell.
</pre>

<p>
If failed changing the default login shell, workaround like the following
example:
</p>
<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-comment-delimiter"># </span><span class="org-comment">For csh, put the following snippet into your ~/.login (which is loaded by</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">login shell only)</span>
<span class="org-keyword">if</span> ( -t 0 ) <span class="org-keyword">then</span> <span class="org-comment-delimiter"># </span><span class="org-comment">interactive shell</span>
    setenv SHELL <span class="org-sh-quoted-exec">`which bash`</span>
    <span class="org-keyword">exec</span> $<span class="org-variable-name">SHELL</span> --login
endif
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Input and key binding</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Getting &lt;Delete&gt; and &lt;Backspace&gt; to work just right</h3>
<div class="outline-text-3" id="text-2-1">
<p>
It is nontrivial, but the first thing you should try is:
</p>
<div class="org-src-container">

<pre class="src src-shell-script">stty ^?
</pre>
</div>

<p>
If that does not work, read the following links for more details
</p>
<ul class="org-ul">
<li><a href="tmux.html">Fix delete &amp; backspace in tmux</a>
</li>
<li><a href="http://www.tldp.org/HOWTO/Keyboard-and-Console-HOWTO-5.html">Keyboard-and-Console-HOWTO: Delete and Backspace</a>
</li>
<li><a href="http://www.faqs.org/docs/Linux-mini/BackspaceDelete.html">Linux Backspace/Delete mini-HOWTO</a>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">To disable enable XON/XOFF flow control</h3>
<div class="outline-text-3" id="text-2-2">
<p>
By default, the flow control is enabled. That is, if <code>C-s</code> is pressed, the
output will "freeze". Note that the terminal is still accepting inputs, it is
just the output that is paused. A <code>C-q</code> will restart the output.
</p>

<p>
Nowadays, we are using terminal emulators most of the time and this feature
only services to obfuscate and confuse. Hence, turn it off with the
following command:
</p>

<div class="org-src-container">

<pre class="src src-shell-script">stty -ixon
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-2-3" class="outline-3">
<h3 id="sec-2-3">To enter special characters in Bash CLI</h3>
<div class="outline-text-3" id="text-2-3">
<p>
Use <code>C-q</code> or <code>C-v</code> to escape the characters. For example, to enter ^M,
i.e. '\r' (CR: Carriage Return, ascii 0x0d):
</p>

<ol class="org-ol">
<li>Press <code>C-q</code> (or <code>C-v</code> if <code>C-q</code> is interpreted as XOFF)
</li>

<li>Then, press <code>C-m</code>
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-2-4" class="outline-3">
<h3 id="sec-2-4">Customize key bindings</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li>To list available key-bindings
<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-builtin">bind</span> -p
</pre>
</div>
</li>

<li>Refer to inputrc section in <a href="#sec-13">my profile</a>
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Session types</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>"login shell" versus "non-login shell"
</li>

<li>"interactive shell" versus "non-interactive shell"
</li>

<li>An example

<p>
<code>ssh remote_host cmd</code> starts an interactive but non-login shell
(hence source in <code>.bashrc</code> but not <code>.bash_profile</code>) and run 'cmd'
rather then just run 'cmd' directly. In this case, the shell is,
even though indeed a non-interactive shell, technically an ephemeral
<b>interactive but NO terminal</b> shell, .
</p>

<p>
This case also implies, in my opinion, that <code>[ -t 0 ]</code> is better
than <code>[ -n "$PS1" ]</code> in terms of testing if a shell is really
interactive since <code>[ -t 0 ]</code> always fails in this case.
</p>
</li>
</ul>

<p>
(Hints: <code>.bash_profile</code>, <code>.bashrc</code>, alias etc.)
</p>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Commands types</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">To find out what a "command" really is</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li><code>type [-a] cmd</code>
</li>
<li><code>help cmd</code> (for shell builtin, like <code>man</code> for non-builtins)
</li>
<li><code>which cmd</code>
</li>
<li><code>whereis cmd</code>
</li>
</ul>

<pre class="example">
$ type printf
printf is a shell builtin

$ type -a printf
printf is a shell builtin
printf is /usr/bin/printf

$ help printf
printf: printf [-v var] format [arguments]
     printf formats and prints ARGUMENTS under control of the FORMAT. FORMAT
     ...

$ which printf
/usr/bin/printf

$ whereis printf
printf: /usr/bin/printf /usr/include/printf.h ...
</pre>
</div>
</div>

<div id="outline-container-sec-4-2" class="outline-3">
<h3 id="sec-4-2">To escape aliases</h3>
<div class="outline-text-3" id="text-4-2">
<p>
Prepend the command with a backslash. Say, your <code>ls</code> is an alias to <code>ls
   --color=auto</code>, and now you want the original <code>ls</code>. just <code>\ls</code>.
</p>

<p>
<b>NOTE</b> that, in bash, aliases are disabled automatically in non-interactive
sessions (scripts).
</p>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Navigating among directories</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">shell options</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>autocd
</li>
<li>cdspell
</li>
<li>dirspell
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-2" class="outline-3">
<h3 id="sec-5-2">pushd</h3>
<div class="outline-text-3" id="text-5-2">
<p>
For bash, check (info "(bash) Directory Stack Builtins") for usage of
pushd, popd, dirs. Refer to my profile for a simple wrapper which makes it
even more convenient.
</p>
</div>
</div>

<div id="outline-container-sec-5-3" class="outline-3">
<h3 id="sec-5-3">directory bookmark</h3>
<div class="outline-text-3" id="text-5-3">
<p>
Also, take a look at the lsdm, dN, gN (and dumpdm, loaddm) in my profile.
This solution is complementary to pushd. It facilitates bookmarking
directories.
</p>

<dl class="org-dl">
<dt> dN </dt><dd>bookmark current directory as <code>gN</code>
</dd>
<dt> gN </dt><dd>goto corresponding bookmarked directory
</dd>
<dt> lsdm </dt><dd>list current directory bookmark
</dd>
</dl>

<p>
Here is an example of how to use it:
</p>

<ul class="org-ul">
<li>Remember directories and jump to them easily

<pre class="example">
[994] 10:05:46 lungangfang@qdbuild2 ~
$ cd sandbox/main/TelicaRoot/components/sp_system/scripts_rhx86/

[995] 10:05:59 lungangfang@qdbuild2 ~/sandbox/main/TelicaRoot/components/sp_system/scripts_rhx86
$ d0

[1000] 10:06:02 lungangfang@qdbuild2 ~/sandbox/main/TelicaRoot/components/sp_system/scripts_rhx86
$ lsdm
g0='cd /home/lungangfang/sandbox/main/TelicaRoot/components/sp_system/scripts_rhx86'

[1001] 10:06:05 lungangfang@qdbuild2 ~/sandbox/main/TelicaRoot/components/sp_system/scripts_rhx86
$ cd ~/tmp

[1002] 10:06:11 lungangfang@qdbuild2 ~/tmp
$ d1

[1003] 10:06:51 lungangfang@qdbuild2 ~/tmp
$ cd ~/doc/sdm

[1004] 10:06:59 lungangfang@qdbuild2 ~/doc/sdm
$ d2

[1005] 10:07:03 lungangfang@qdbuild2 ~/doc/sdm
$ lsdm
g0='cd /home/lungangfang/sandbox/main/TelicaRoot/components/sp_system/scripts_rhx86'
g1='cd /home/lungangfang/tmp'
g2='cd /home/lungangfang/doc/sdm'

[1006] 10:07:05 lungangfang@qdbuild2 ~/doc/sdm
$ g0

[1007] 10:07:08 lungangfang@qdbuild2 ~/sandbox/main/TelicaRoot/components/sp_system/scripts_rhx86
$ g1

[1008] 10:07:11 lungangfang@qdbuild2 ~/tmp
$ g2

[1009] 10:07:13 lungangfang@qdbuild2 ~/doc/sdm
</pre>
</li>

<li>Persist and load directory marks between sessions

<pre class="example">
[1030] 10:09:24 lungangfang@qdbuild2 ~/sandbox/fid16665
$ cat ~/.dir_mark
alias g0='cd /home/lungangfang/sandbox/aluac'
alias g1='cd /home/lungangfang/sandbox/BRANCH-8-3-0-5'
alias g2='cd /home/lungangfang/sandbox/fid16665'


[1031] 10:09:11 lungangfang@qdbuild2 ~/sandbox/fid16665
$ loaddm

[1030] 10:09:22 lungangfang@qdbuild2 ~/sandbox/fid16665
$ lsdm
g0='cd /home/lungangfang/sandbox/aluac'
g1='cd /home/lungangfang/sandbox/BRANCH-8-3-0-5'
g2='cd /home/lungangfang/sandbox/fid16665'

[1032] 10:13:11 lungangfang@qdbuild2 ~/sandbox/fid16665
$ d0

[1033] 10:14:28 lungangfang@qdbuild2 ~/sandbox/fid16665
$ dumpdm

[1034] 10:14:38 lungangfang@qdbuild2 ~/sandbox/fid16665
$ cat ~/.dir_mark
alias g0='cd /home/lungangfang/sandbox/fid16665'
alias g1='cd /home/lungangfang/sandbox/BRANCH-8-3-0-5'
alias g2='cd /home/lungangfang/sandbox/fid16665'
</pre>

<p>
If you are using bash, maybe you can put "dumpdm" to <code>.bash_logout</code> to
automatically dump directory marks. and put "loaddm" into <code>.bash_profile</code>
(or <code>.bashrc</code>) to load directory marks automatically.
</p>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-5-4" class="outline-3">
<h3 id="sec-5-4">CDPATH</h3>
<div class="outline-text-3" id="text-5-4">
<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-comment-delimiter"># </span><span class="org-comment">remember to put the '.' at the beginning</span>
<span class="org-variable-name">CDPATH</span>=.:/home/lgfang:/local/home/lgfang
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-5-5" class="outline-3">
<h3 id="sec-5-5">cd to a similar hierarchy</h3>
<div class="outline-text-3" id="text-5-5">
<p>
Say, you are in "/home/lgfang/1.0/demo/test" and you want to change directory
to "/home/lgfang/2.0/demo/test".
</p>

<p>
In ksh, you can just <code>cd 1.0 2.0</code>, but Bash does not provide this. Here is
small function to simulate that.
</p>

<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-keyword">function</span> <span class="org-function-name">cdr</span> {
    <span class="org-comment-delimiter"># </span><span class="org-comment">cdr from to</span>
    <span class="org-keyword">if</span> [ $<span class="org-variable-name">#</span> -ne 2 ]; <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"Usage: cdr from to"</span> &gt;&amp;2
        <span class="org-keyword">return</span> 1
    <span class="org-keyword">fi</span>

    <span class="org-builtin">cd</span> <span class="org-string">"${PWD/$1/$2}"</span>
}
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Command history</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">Recall previous command</h3>
<div class="outline-text-3" id="text-6-1">
<p>
In addition to <code>C-r</code> (suppose you have not <code>set -o vi</code>) to search backward in
command history, this section gives some examples for other frequently used
features.
</p>

<p>
For more detailed and more accurate info, refer to (info "(bash)Using History
Interactively").
</p>

<ul class="org-ul">
<li>Before try the techniques described below, you might want to add this to
profile so that you get a chance to look at the resulted command instead of
running it directly.
<pre class="example">
shopt -s histverify
</pre>
</li>

<li><code>!N:xxx</code> to retrieve the N^th command and tweak it.

<p>
Suppose the 1025^th command is this:
</p>
<pre class="example">
$ to -a -s bono08
</pre>

<p>
Then:
</p>
<pre class="example">
| input                | result          | comment                  |
|----------------------+-----------------+--------------------------|
| !1025                | to -a -s bono08 | the whole command        |
| !1025:*              | -a -s bono08    | all parameters           |
| !1025:^              | -a              | first parameter          |
| !1025:$              | bono08          | last parameter           |
| !1025:2-3            | -s bono08       | 2nd-3rd parameters       |
| !1025:s/bono08/hp25/ | to -a -s hp25   | replace bono08 with hp25 |
</pre>
</li>

<li><code>!str:xxx</code> works the same way except it designates the last command which
starts with string "str".
</li>

<li><code>!#:xxx</code> for current command line typed so far
</li>

<li><code>!!:xxx</code> for the last command
</li>

<li><code>!-N:xxx</code> for command N lines back (<code>!-1 == !!</code>).
</li>

<li>To print history number in PS1
<pre class="example">
export PS1='[\!]\$ '
</pre>
</li>

<li>Refer to my profile for the usage of <code>history-search-backward</code>.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2">To disable history temporarily</h3>
<div class="outline-text-3" id="text-6-2">
</div><div id="outline-container-sec-6-2-1" class="outline-4">
<h4 id="sec-6-2-1">Ignore commands started with spaces</h4>
<div class="outline-text-4" id="text-6-2-1">
<pre class="example">
export HISTCONTROL="ignorespace"
</pre>

<p>
Issue of this method is that you tend to forget to prepend a space to all
commands.
</p>
</div>
</div>

<div id="outline-container-sec-6-2-2" class="outline-4">
<h4 id="sec-6-2-2">Ignore all commands within current session</h4>
<div class="outline-text-4" id="text-6-2-2">
<pre class="example">
unset HISTFILE
</pre>
<p>
or
</p>
<pre class="example">
export HISTFILE=/dev/null
</pre>

<p>
The advantages of this way over previous one are:
</p>

<ol class="org-ol">
<li>The history is still available until the session end. It is just not
saved on exit. To be accurate, it is saved to nowhere (<code>/dev/null</code>).
</li>

<li>This can be done afterwards. That is, you may run some commands before you
aware that you want to hide them. It does not matter. Just make sure you
run unset "HISTFILE" before you close the session.
</li>
</ol>

<p>
<b>NOTE:</b> <code>unset</code> is NOT inherited by child shells. Therefore, you <code>unset
    HISTFILE</code> before starting a tmux session does not take effect. Hence, <code>unset
    HISTFILE</code> is a good interim solution (autocompletion of var) while an alias
of <code>export HISTFILE=/dev/null</code> seems a good candidate for long-term
approach.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3">To edit command history</h3>
<div class="outline-text-3" id="text-6-3">
</div><div id="outline-container-sec-6-3-1" class="outline-4">
<h4 id="sec-6-3-1">By editing history file</h4>
<div class="outline-text-4" id="text-6-3-1">
<p>
Even though BASH provides <code>history -d xxx</code> to delete history entries, I found
it is way more convient and straightforward to just edit the history file.
</p>

<ol class="org-ol">
<li>If there are other shells, quit them or unset their HISTFILE.

<p>
Every shell load history on start and write history on quit. This step is
to ensure existing shells will not overwrite the history file.
</p>
</li>

<li>Unset HISTFILE in current shell.

<p>
Do not overwrite history file with current shell's history either.
</p>
</li>

<li>Edit and save history file in current shell.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-6-3-2" class="outline-4">
<h4 id="sec-6-3-2">Using <code>history -d</code></h4>
<div class="outline-text-4" id="text-6-3-2">
<p>
If you do want to use <code>history -d</code>, here are my two cents
</p>

<ol class="org-ol">
<li>Note that the history numbers shift every time you delete a command
history. (Consequently, you may want to delete commands bottom up.)
</li>

<li>Note that the <code>history -d xxx</code> itself also gets into the history.
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4">Related shell options</h3>
<div class="outline-text-3" id="text-6-4">
<p>
Refer to my profile
</p>
</div>
</div>

<div id="outline-container-sec-6-5" class="outline-3">
<h3 id="sec-6-5">Related key binding</h3>
<div class="outline-text-3" id="text-6-5">
<p>
Refer to my profile
</p>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">Command completion</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">Completion scripts</h3>
<div class="outline-text-3" id="text-7-1">
<p>
Usually, we do not write scripts of programmable completion by ourselves. We
just google and download ready-made scripts.
</p>

<p>
To "install" those scripts,
</p>

<ul class="org-ul">
<li>Simply put them file into a standard completion directory such as
<code>/etc/bash_completion.d/</code>. Or,
</li>

<li>Put them to anywhere you see as appropriate and source it in your bashrc.
<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-keyword">if</span> [ -d $<span class="org-variable-name">HOME</span>/.bash_completion.d ]; <span class="org-keyword">then</span>
    <span class="org-keyword">for</span> each<span class="org-keyword"> in</span> $<span class="org-variable-name">HOME</span>/.bash_completion.d/*; <span class="org-keyword">do</span>
        <span class="org-builtin">source</span> $<span class="org-variable-name">each</span>
    <span class="org-keyword">done</span>
<span class="org-keyword">fi</span>
</pre>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2">Write your own simple complete</h3>
<div class="outline-text-3" id="text-7-2">
<p>
To write your own auto-completion, it is really easy to get started. Here is
an example:
</p>

<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-builtin">complete</span> -W <span class="org-string">"list of all words for an automatic completion"</span> your_command
</pre>
</div>

<p>
Refer to following resources for more details
<a href="http://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html#Programmable-Completion-Builtins">http://www.gnu.org/software/bash/manual/html_node/Programmable-Completion-Builtins.html#Programmable-Completion-Builtins</a>
<a href="http://www.debian-administration.org/article/316/An_introduction_to_bash_completion_part_1">http://www.debian-administration.org/article/316/An_introduction_to_bash_completion_part_1</a>
<a href="http://www.debian-administration.org/article/316/An_introduction_to_bash_completion_part_2">http://www.debian-administration.org/article/316/An_introduction_to_bash_completion_part_2</a>
</p>
</div>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">Make use of "Job Control"</h2>
<div class="outline-text-2" id="text-8">
<ul class="org-ul">
<li>Assuming you have only one session and you are debugging a script. You are
constantly switching between vim and CLI. You do not have to enter and quit
vim again and again. Just put the vim to background using <code>C-z</code> to run
command in CLI. After that, bring vim to foreground using <code>fg</code>.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Colors</h2>
<div class="outline-text-2" id="text-9">
</div><div id="outline-container-sec-9-1" class="outline-3">
<h3 id="sec-9-1">Colors for <code>ls</code></h3>
<div class="outline-text-3" id="text-9-1">
<ul class="org-ul">
<li>One way to change them as indicated by <code>/etc/profile.d/colorls.sh</code> is to
create your own version of <code>.dir_colors.$TERM</code>.

<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-variable-name">COLORS</span>=/etc/DIR_COLORS
[ -e <span class="org-string">"/etc/DIR_COLORS.$TERM"</span> ] &amp;&amp; <span class="org-variable-name">COLORS</span>=<span class="org-string">"/etc/DIR_COLORS.$TERM"</span>
[ -e <span class="org-string">"$HOME/.dircolors"</span> ] &amp;&amp; <span class="org-variable-name">COLORS</span>=<span class="org-string">"$HOME/.dircolors"</span>
[ -e <span class="org-string">"$HOME/.dir_colors"</span> ] &amp;&amp; <span class="org-variable-name">COLORS</span>=<span class="org-string">"$HOME/.dir_colors"</span>
[ -e <span class="org-string">"$HOME/.dircolors.$TERM"</span> ] &amp;&amp; <span class="org-variable-name">COLORS</span>=<span class="org-string">"$HOME/.dircolors.$TERM"</span>
[ -e <span class="org-string">"$HOME/.dir_colors.$TERM"</span> ] &amp;&amp; <span class="org-variable-name">COLORS</span>=<span class="org-string">"$HOME/.dir_colors.$TERM"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">...</span>
<span class="org-builtin">eval</span> <span class="org-sh-quoted-exec">`dircolors --sh "$COLORS" 2&gt;/dev/null`</span>
</pre>
</div>
</li>

<li>An simpler way is, if you only change one color or two, is to put
the following line into your .bashrc:
<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-builtin">export</span> <span class="org-variable-name">LS_COLORS</span>=<span class="org-string">'di=38;5;33'</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">NOTE: this will wipe out other LS_COLORS settings</span>
</pre>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-9-2" class="outline-3">
<h3 id="sec-9-2">Colors for PS1</h3>
<div class="outline-text-3" id="text-9-2">
<ul class="org-ul">
<li>Format:

<pre class="example">
\[\e[color_code+m\]
</pre>
</li>

<li>Example:

<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-comment-delimiter"># </span><span class="org-comment">for 256-color</span>
<span class="org-variable-name">PS1</span>=<span class="org-string">'\n\[\e[38;5;10m\][\!] \t \[\e[38;5;106m\]\u@\h'</span>
<span class="org-variable-name">PS1</span>=$<span class="org-variable-name">PS1</span><span class="org-string">' \[\e[38;5;33m\]\w\n\[\e[32m\]\$\[\e[0m\] '</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">a similar one for 8-color</span>
<span class="org-variable-name">PS1</span>=<span class="org-string">'\n\[\e[32m\][\!] \t \[\e[33m\]\u@\h'</span>
<span class="org-variable-name">PS1</span>=$<span class="org-variable-name">PS1</span><span class="org-string">' \[\e[34m\]\w\[\e[32m\]\n\$\[\e[0m\] '</span>
</pre>
</div>
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-9-3" class="outline-3">
<h3 id="sec-9-3">Reference:</h3>
<div class="outline-text-3" id="text-9-3">
<p>
<a href="http://misc.flogisoft.com/bash/tip_colors_and_formatting">http://misc.flogisoft.com/bash/tip_colors_and_formatting</a>
</p>

<p>
Also refer to <code>/etc/DIR_COLORS</code> or <code>/etc/DIR_COLORS.256color</code> for detailed
explaination of codes for colors. Even though it is for <code>ls</code>, the codes also
applicable to <code>PS1</code>.
</p>
</div>
</div>

<div id="outline-container-sec-9-4" class="outline-3">
<h3 id="sec-9-4">To show each one of 256 colors in bash</h3>
<div class="outline-text-3" id="text-9-4">
<pre class="example">
for i in {0..255};do echo -e "\x1b[38;5;${i}mcolour${i}"; done
</pre>

<p>
or
</p>

<pre class="example">
for i in {0..255};do printf "\x1b[48;5;${i}m ";done;printf "\x1b[0m\n"
</pre>

<p>
or
</p>

<div class="org-src-container">

<pre class="src src-shell-script"><span class="org-comment-delimiter">#</span><span class="org-comment">!/bin/</span><span class="org-keyword">bash</span>
<span class="org-keyword">for</span> i<span class="org-keyword"> in</span> {0,1,29,30,31};<span class="org-keyword">do</span>
    <span class="org-builtin">printf</span> <span class="org-string">"$((i*8))\t"</span>
    <span class="org-keyword">for</span> j<span class="org-keyword"> in</span> {0..7}; <span class="org-keyword">do</span>
        <span class="org-builtin">printf</span> <span class="org-string">"\x1b[48;5;$((i*8+j))m  "</span>
    <span class="org-keyword">done</span>
    <span class="org-builtin">printf</span> <span class="org-string">"\x1b[0m\n"</span>
<span class="org-keyword">done</span>
<span class="org-keyword">for</span> red<span class="org-keyword"> in</span> {0..5}; <span class="org-keyword">do</span>
    <span class="org-builtin">printf</span> <span class="org-string">"$((16+red*36))\t"</span>
    <span class="org-keyword">for</span> green<span class="org-keyword"> in</span> {0..5};<span class="org-keyword">do</span>
        <span class="org-keyword">for</span> blue<span class="org-keyword"> in</span> {0..5}; <span class="org-keyword">do</span>
            <span class="org-builtin">printf</span> <span class="org-string">"\x1b[48;5;$((16+red*36+green*6+blue))m  "</span>
        <span class="org-keyword">done</span>
        <span class="org-builtin">printf</span> <span class="org-string">"\x1b[0m "</span>
    <span class="org-keyword">done</span>
    <span class="org-builtin">printf</span> <span class="org-string">"\x1b[0m\n"</span>
<span class="org-keyword">done</span>
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10">The safer "rm"</h2>
<div class="outline-text-2" id="text-10">
<pre class="example">
alias rm='rm -I' # This is way better than 'rm -i' and 'rm'
</pre>
</div>
</div>

<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11">Why "cannot access parent directories"</h2>
<div class="outline-text-2" id="text-11">
<p>
If you keep in a directory while it is deleted and recreated in another
session, you may observe "wierd" phenomenon.
</p>

<ol class="org-ol">
<li><code>ls</code> always show "old content".
</li>

<li>For some commands, you may get the following error:

<p>
Shell-init: error retreieving current directory: getcwd: cannot access
parent directories: No such file or directory.
</p>
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12">Why command output does not show up realtime</h2>
<div class="outline-text-2" id="text-12">
<p>
Stdout are usually line-buffered when connected to display and block-buffered
when redirected into files. For the later case, the ouput may not show up
timely or even may not appear at all. Some examples:
</p>

<ol class="org-ol">
<li>If you redirect logs into a log file and tail the log, there is usually a
delay.
</li>
<li>"tcpdump -i ethN | grep some_thing" may not work as you expect (matched
lines may not show at all or there will be huges delays). You should use
option "-l" to make tcpdump stdout line buffered.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13">My profile</h2>
<div class="outline-text-2" id="text-13">
<ul class="org-ul">
<li><a href="https://github.com/lgfang/dotfiles/blob/master/.bash_profile">.bash_profile</a>
</li>
<li><a href="https://github.com/lgfang/dotfiles/blob/master/.bashrc">.bashrc</a>
</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">

     <br/>
     <p>
     <span class="date">Created: 2015-12-09 Wed 15:06</span> by <span class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.5.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</span>
     </p>

     <!-- DISQUS  -->
     <div id="disqus_thread"></div>
     <script type="text/javascript">
         /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
         var disqus_shortname = 'lgfang'; // required: replace example with your forum shortname

         /* * * DON'T EDIT BELOW THIS LINE * * */
         (function() {
             var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
             dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
             (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
         })();
     </script>
     <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
     <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

     <!-- google analytic -->
     <script>
       (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
       (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
       m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
       })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

       ga('create', 'UA-84711243-1', 'auto');
       ga('send', 'pageview');

     </script>
</div>
</div>
</body>
</html>
