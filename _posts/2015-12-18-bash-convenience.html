---
layout: post
title: Some BASH CLI Convenience Settings
tagline: that make your life easier
categories: computer
tags: [bash, shell, linux tools]
---


<div class="figure">
<p><img src="http://lgfang.github.io/images/./bash-fancy-ps1.png" alt="bash-fancy-ps1.png" width="1000" />
</p>
</div>

<p>
Working in BASH CLI can be really a pleasure. My BASH configuration
(<a href="https://github.com/lgfang/dotfiles/blob/master/.bash_profile">.bash_profile</a> &amp; <a href="https://github.com/lgfang/dotfiles/blob/master/.bashrc">.bashrc</a>) provides, among others, the following frequently-used
and really handy features (for more tips on using BASH as a CLI, please read
<a href="http://lgfang.github.io/images/../mynotes/util/shell-cli.html">http://lgfang.github.io/images/../mynotes/util/shell-cli.html</a>):
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Informative PS1</h2>
<div class="outline-text-2" id="text-1">
<p>
As shown in the picture above, you will get a PS1 which presents the
following information:
</p>

<ul class="org-ul">
<li>Event number: you can re-run previous command line by <code>!&lt;event number&gt;</code>,
for example <code>!1063</code> or select only the first argument like this: <code>!1063:1</code>
</li>

<li>Timestamp: gives you a hint of when previous command ends.
</li>

<li>MY_WARN/MY_EXTRA: you may set these two variables to show extra information
and/or error messages as you want. For me, I often use MY_WARN indicate if
I have source in certain harzadous configure file.
</li>

<li>Current git branch: if you are in a git repository, this tells you the
current branch.
</li>
</ul>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Search and re-run previous command which starts with xxx</h2>
<div class="outline-text-2" id="text-2">
<p>
For examle, just type <code>grep a</code> and then repeat <code>&lt;Alt&gt;-p</code>, you will be able to
see and select previous commands that starts with <code>grep a</code>.
</p>

<p>
Note that for putty users, <b>right</b> <code>&lt;Alt&gt;</code> does NOT work since it is actually
<code>&lt;AltGr&gt;</code>).
</p>

<p>
This is superior than traditional history search in two ways:
</p>
<ol class="org-ol">
<li>You can launch the search after you have already typed something.
</li>
<li>It matches only the commands that start with the string, which is what we
want most of time.
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Bookmark directories</h2>
<div class="outline-text-2" id="text-3">
<p>
You can bookmark frequently accessed directories and jump to them at ease
with commands <code>dm</code>, <code>dj</code>, and <code>lsdm</code> from me.
</p>


<div class="figure">
<p><img src="http://lgfang.github.io/images/./bash-dir-bookmark.png" alt="bash-dir-bookmark.png" width="779" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">cd recent directories (i.e. "cd +n")</h2>
<div class="outline-text-2" id="text-4">
<p>
The history of my "cd" is recorded and can be easily re-applied. This is
achieved by a BASH function <code>cd</code> written by me based on the built-in <code>pushd</code>.
</p>


<div class="figure">
<p><img src="http://lgfang.github.io/images/./bash-dir-stack.png" alt="bash-dir-stack.png" width="773" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">cd path substitution (i.e. "cd from to")</h2>
<div class="outline-text-2" id="text-5">
<p>
This is inspired by KSH and is also implemented in my <code>cd</code> function.
</p>


<div class="figure">
<p><img src="http://lgfang.github.io/images/./bash-cd-replace.png" alt="bash-cd-replace.png" width="843" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">cd up multiple levels (i.e. "cd &#x2026;.")</h2>
<div class="outline-text-2" id="text-6">
<p>
Inspired by eshell(Emacs), implemented in my <code>cd</code> function.
</p>


<div class="figure">
<p><img src="http://lgfang.github.io/images/./bash-cd-dots.png" alt="bash-cd-dots.png" width="918" />
</p>
</div>
</div>
</div>

<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">Automatically attach to or create a tmux session.</h2>
<div class="outline-text-2" id="text-7">
<p>
Tmux is an awesome terminal multiplexer (see <a href="http://lgfang.github.io/images/../mynotes/util/tmux-intro.html">this post</a> for more
introduction). I use it practically every day and strongly recommend you give
it a shot.
</p>

<p>
<code>tg</code> is a bash function written by me to allow me to type less.
</p>

<p>
Run <code>tg</code> without any argument, you will be prompted to select one session
from existing sessions. If there is no session at all, a session named "misc"
will be created and attached to without prompt.
</p>

<p>
Run <code>tg name</code> will attach to the session named "name". If such session does
not exist, it will be created first.
</p>

<p>
Please note that <code>tg</code> runs tmux with option <code>-2</code>, i.e. force tmux to assume
the terminal supports 256 colours.
</p>
</div>
</div>

<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">Push to gerrit (for code review)</h2>
<div class="outline-text-2" id="text-8">
<p>
Run <code>gerrit</code> instead of <code>git push refs/for/&lt;current_branch_name&gt;</code> to submit
code to gerrit for review.
</p>

<p>
Or, <code>gerrit branch_name</code> to push to a branch other than current branch for
review.
</p>
</div>
</div>

<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Go to current path of emacsclient</h2>
<div class="outline-text-2" id="text-9">
<p>
If you use emacs in *nix, you shall be using emacs daemon/client. If you use
emacsclient, you may find this command handy when you need it. IIRC, this is
inspired by <a href="http://coldnew.github.io/">coldnew</a>.
</p>


<div class="figure">
<p><img src="http://lgfang.github.io/images/./bash-ep.png" alt="bash-ep.png" width="973" />
</p>
</div>
</div>
</div>
